<head>
  <title>datalog</title>
</head>

<body>
  <div class="container">
    {{> loginButtons align="right" }}
    {{> app }}
    </div>
</body>

<template name="app">
  <div class="row">
    <div class="col-md-12">
      {{> list_things_table }}
    </div>
  </div>
  <div class="row">
    <div class="col-md-6">
      {{> new_thing }}
    </div>
    <div class="col-md-6">
      {{> edit_thing }}
    </div>
  </div>
  <div class="row">
    <div class="col-md-6">
      {{> new_thingfield }}
      {{> edit_thingfield }}
    </div>
    <div class="col-md-6">
      {{> list_thingfields }}
    </div>
  </div>
</template>

<template name="new_thing">
  <h1>New Thing</h1>
  <form rel="form" class="form">
    {{#each thingfields }}
    <div class="form-group">
      {{> Template.dynamic template=new_thing_template }}
    </div>
    {{/each}}
    <div class="form-group">
      <input type="submit" class="btn" value="Save">
    </div>
  </form>
</template>

<template name="new_thing_text">
  <label for="new_{{ label }}">{{ label }}</label>
  <input id="new_{{ label }}" type="text" class="form-control">
</template>

<template name="new_thing_datepicker">
  <label for="new_{{ label }}">{{ label }}</label>
  <div class="input-group date" id="new_thing_datepicker">
    <input id="new_{{ label }}" type="text" class="form-control" data-date-format="YYYY-MM-DD">
    <span class="input-group-addon"><span class="glyphicon glyphicon-calendar"></span></span>
  </div>
</template>

<template name="edit_thing">
  <h1>Edit Thing</h1>
  <form rel="form" class="form">
    {{#each thingfields }}
    <div class="form-group">
      {{> Template.dynamic template=edit_thing_template }}
    </div>
    {{/each}}
    <div class="form-group">
      <input type="submit" class="btn" value="Save">
    </div>
  </form>
</template>

<template name="edit_thing_text">
  <label for="edit_{{ label }}">{{ label }}</label>
  <input id="edit_{{ label }}" type="text" class="form-control" value="{{ value }}">
</template>

<template name="edit_thing_datepicker">
  <label for="edit_{{ label }}">{{ label }}</label>
  <div class="input-group date" id="edit_datepicker">
    <input id="edit_{{ label }}" type="text" class="form-control" data-date-format="YYYY-MM-DD" value="{{ value }}">
    <span class="input-group-addon"><span class="glyphicon glyphicon-calendar"></span></span>
  </div>
</template>

<template name="list_things_table">
  <h1>Things</h1>
  <table class="table table-responsive table-condensed table-striped">
    <thead>
      <tr>
	{{#each thingfields }}
	<th>{{ label }}</th>
	{{/each}}
      </tr>
    </thead>
    <tbody>
      {{#each things }}
      <tr>
	{{#each thingfields }}
	<td>{{ thingValue }}</td>
	{{/each}}
      </tr>
      {{/each}}
    </tbody>
  </table>
</template>

<template name="new_thingfield">
  <h1>Add New Thingfield</h1>
  <form rel="form" class="form">
    <div class="form-group">
      <label for="label">Label</label>
      <input id="label" type="text" class="form-control">
    </div>
    <div class="form-group">
      <label for="data_type">Data Type</label>
      <select id="data_type" class="form-control">
        {{#each validFieldTypes }}
        <option>{{ this }}</option>
        {{/each}}
      </select>
    </div>
    <div class="form-group">
      <input type="submit" class="btn" value="Save">
    </div>
  </form>
</template>

<template name="edit_thingfield">
  <h1>Edit Thingfield</h1>
  <form rel="form" class="form">
    <div class="form-group">
      <label for="edit_label">Label</label>
      <input id="edit_label" type="text" class="form-control" value="{{ label }}">
    </div>
    <div class="form-group">
      <label for="edit_data_type">Data Type</label>
      <select id="edit_data_type" class="form-control">
        {{#each validFieldTypes }}
        <option {{ selected }}>{{ this }}</option>
        {{/each}}
      </select>
    </div>
    <div class="form-group">
      <input type="submit" class="btn" value="Save">
    </div>
  </form>
</template>

<template name="list_thingfields">
  <h3>Thingfields</h3>
  <ol>
  {{#each thingfields }}
  <li><b>{{ label }}</b> <small class="text-muted">{{ dtype }}</small></li>
  {{/each}}
  </ol>
</template>
